Vagrant.configure("2") do |config|

	# Load config JSON
	setup_config_path = "<%= @config_path %>"
	setup_config = JSON.parse(File.read(setup_config_path))

	# Base box
	config.vm.box = "precise32"
	config.vm.box_url = "http://files.vagrantup.com/precise32.box"

	# Networking
	config.vm.network :private_network, ip: setup_config["ip"]

	# Customize provider
	config.vm.provider :virtualbox do |vb|
		# RAM
		vb.customize ["modifyvm", :id, "--memory", setup_config["memory"]]

		# Synced Folder
		config.vm.synced_folder setup_config["synced_folder"]["host_path"], setup_config["synced_folder"]["guest_path"]
	end

	# Customize provisioner
	config.vm.provision :chef_solo do |chef|
		chef.json = setup_config

		chef.cookbooks_path = "<%= @cookbooks_path %>"

		chef.roles_path = "<%= @roles_path %>"

		# Add roles
		setup_config["roles"].each do |role|
			chef.add_role role
		end
	end

end
